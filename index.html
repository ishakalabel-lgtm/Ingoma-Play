<!DOCTYPE html>
<html lang="rw">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ingoma Play</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#000;
  color:#fff;
  text-align:center;
}

header{
  padding:15px;
  border-bottom:1px solid #222;
}

#appTitle{
  font-size:26px;
  font-weight:bold;
  color:#ff0000;
  cursor:pointer;
  user-select:none;
}

#adminPanel{
  display:none;
  margin-top:20px;
  padding:15px;
  border:1px solid #333;
  background:#111;
}

button{
  padding:10px 15px;
  margin:5px;
  border:none;
  border-radius:5px;
  cursor:pointer;
}

.btn-danger{background:#c00;color:#fff;}
.btn-ok{background:#0a0;color:#fff;}
</style>
</head>

<body>

<header>
  <!-- TEXT INGOMA PLAY (ADMIN CLICK) -->
  <div id="appTitle">INGOMA PLAY</div>
</header>

<main>
  <p>Murakaza neza kuri Ingoma Play üé∂</p>

  <!-- ADMIN PANEL -->
  <div id="adminPanel">
    <h3>ADMIN PANEL</h3>
    <p>Uri muri admin mode</p>

    <button class="btn-ok" onclick="listStorage()">Raba Storage</button>
    <button class="btn-danger" onclick="logoutAdmin()">Sohoka Admin</button>

    <div id="output" style="margin-top:10px;font-size:14px;"></div>
  </div>
</main>

<script>
/* ================= SUPABASE CONFIG ================= */
const SUPABASE_URL = "https://fmrjmanvrydfmpiiaoap.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZtcmptYW52cnlkZm1waWlhb2FwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk1ODczNzgsImV4cCI6MjA4NTE2MzM3OH0.hKz4cDWEfyb7yubBbY3OKQPzh_GnodmKfVvm_5NNoiY";

const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

/* ================= ADMIN CLICK SYSTEM ================= */
let clickCount = 0;
let isAdmin = false;
const ADMIN_PIN = "9999";

document.getElementById("appTitle").addEventListener("click", () => {
  clickCount++;

  if(clickCount === 10){
    clickCount = 0;
    const pin = prompt("Shiramwo PIN ya Admin:");
    if(pin === ADMIN_PIN){
      enableAdmin();
    }else{
      alert("PIN siyo ‚ùå");
    }
  }
});

function enableAdmin(){
  isAdmin = true;
  document.getElementById("adminPanel").style.display = "block";
  alert("Winjiye muri ADMIN MODE ‚úÖ");
}

function logoutAdmin(){
  isAdmin = false;
  document.getElementById("adminPanel").style.display = "none";
  alert("Wasohotse muri admin");
}

/* ================= STORAGE (PUBLIC) ================= */
async function listStorage(){
  if(!isAdmin) return;

  const { data, error } = await supabase
    .storage
    .from("public") // izina rya bucket (ushobora kurihindura)
    .list("", { limit: 20 });

  const output = document.getElementById("output");
  output.innerHTML = "";

  if(error){
    output.innerHTML = "Ikosa: " + error.message;
    return;
  }

  if(data.length === 0){
    output.innerHTML = "Storage irimwo ubusa.";
    return;
  }

  data.forEach(file => {
    output.innerHTML += "üìÅ " + file.name + "<br>";
  });
}
</script>

</body>
</html>
